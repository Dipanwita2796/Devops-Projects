server {
    listen 80;
    server_name localhost;
    rewrite ^ https://$server_name$request_uri? permanent;
}
server {
    listen 443 ssl default_server;
    server_name localhost;
    #add_header Access-Control-Allow-Origin localhost;
    ssl on;
    ssl_certificate /etc/ssl/ssl-bundle.crt;
    ssl_certificate_key /etc/ssl/xlrt.key;

    #charset koi8-r;
    #access_log  /var/log/nginx/host.access.log  main;

       root   /usr/share/nginx/html/;

location / {
               alias   /usr/share/nginx/html/combined-ui/;
               try_files $uri $uri/ /index.html;
         }
      location /auth-api/{
          resolver 127.0.0.1 valid=30s;
          proxy_http_version 1.1;
                  proxy_set_header Connection "";
                  proxy_set_header Host $host;
          proxy_set_header X-Real-IP $remote_addr;
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                  proxy_buffering off;
          proxy_pass  http://${privatedns}:8888/;
        }
       location /auth-swagger/{
           proxy_set_header X-Forwarded-Host $host/auth-api/;
           proxy_set_header X-Forwarded-Proto $scheme;
           proxy_pass  http://${privatedns}:8888/;
        }

       location /docparser-gateway-api/ {
           resolver 127.0.0.1 valid=30s;
           proxy_http_version 1.1;
           proxy_set_header Connection "";
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_buffering off;
           proxy_pass  http://${privatedns}:8070/;
        }
       location /docparser-swagger/ {
             proxy_set_header X-Forwarded-Host $host/docparser-gateway-api/;
             proxy_set_header X-Forwarded-Proto $scheme;
             proxy_pass  http://${privatedns}:8070/;
        }
       location /dms-api/{
           resolver 127.0.0.1 valid=30s;
           proxy_http_version 1.1;
           proxy_set_header Connection "";
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_buffering off;
           proxy_pass  http://${privatedns}:8087/;
        }
       location /dms-swagger/{
           proxy_set_header X-Forwarded-Host $host/dms-api/;
           proxy_set_header X-Forwarded-Proto $scheme;
           proxy_pass  http://${privatedns}:8087/;
        }

        location /notification-api/ {
            resolver 127.0.0.1 valid=30s;
            proxy_http_version 1.1;
            proxy_set_header Connection "";
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_buffering off;
            proxy_pass  http://${privatedns}:8099/;
        }
       location /notification-swagger/{
           proxy_set_header X-Forwarded-Host $host/notification-api/;
           proxy_set_header X-Forwarded-Proto $scheme;
           proxy_pass  http://${privatedns}:8099/;
        }

       location /reference-data-api/ {
           resolver 127.0.0.1 valid=30s;
           proxy_http_version 1.1;
           proxy_set_header Connection "";
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_buffering off;
           proxy_pass  http://${privatedns}:8084/;
        }
       location /reference-swagger/ {
           proxy_set_header X-Forwarded-Host $host/reference-data-api/;
           proxy_set_header X-Forwarded-Proto $scheme;
           proxy_pass  http://${privatedns}:8084/;
        }

       location /template-management-api/ {
           resolver 127.0.0.1 valid=30s;
           proxy_http_version 1.1;
           proxy_set_header Connection "";
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_buffering off;
           proxy_pass  http://${privatedns}:8086/;
        }

       location /template-swagger/ {
             proxy_set_header X-Forwarded-Host $host/template-management-api/;
             proxy_set_header X-Forwarded-Proto $scheme;
             proxy_pass  http://${privatedns}:8086/;
        }
       location /fst-api/ {
           resolver 127.0.0.1 valid=30s;
           proxy_http_version 1.1;
           proxy_set_header Connection "";
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_buffering off;
           proxy_pass  http://${privatedns}:8071/;
        }

       location /fst-swagger/ {
            proxy_set_header X-Forwarded-Host $host/fst-api/;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_pass  http://${privatedns}:8071/;
        }
       location /fst-fencing-api/ {
           resolver 127.0.0.1 valid=30s;
           proxy_http_version 1.1;
           proxy_set_header Connection "";
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_buffering off;
           proxy_pass  http://${privatedns}:8110/;
        }

       location /fst-fencing-swagger/ {
            proxy_set_header X-Forwarded-Host $host/fst-fencing-api/;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_pass  http://${privatedns}:8110/;
        }
    
           location /expression-eval-api/ {
           resolver 127.0.0.1 valid=30s;
           proxy_http_version 1.1;
           proxy_set_header Connection "";
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_buffering off;
           proxy_pass  http://${privatedns}:8092/;
        }

       location /expression-swagger/ {
         proxy_set_header X-Forwarded-Host $host/expression-eval-api/;
         proxy_set_header X-Forwarded-Proto $scheme;
         proxy_pass  http://${privatedns}:8092/;
       }
    
       location /config-server-api/ {
           resolver 127.0.0.1 valid=30s;
           proxy_pass  http://${privatedns}:8101/;
        }

           location /reporting-api/ {
           resolver 127.0.0.1 valid=30s;
           proxy_http_version 1.1;
           proxy_set_header Connection "";
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_buffering off;
           proxy_pass  http://${privatedns}:8104/;
       }

       location /reporting-swagger/ {
         proxy_set_header X-Forwarded-Host $host/reporting-api/;
         proxy_set_header X-Forwarded-Proto $scheme;
         proxy_pass http://${privatedns}:8104/;
       }

       location /gstitr-api/ {
           resolver 127.0.0.1 valid=30s;
           proxy_http_version 1.1;
           proxy_set_header Connection "";
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_buffering off;
           proxy_pass  http://${privatedns}:8076/;
        }

        location /gstitr-swagger/ {
         proxy_set_header X-Forwarded-Host $host/gstitr-api/;
         proxy_set_header X-Forwarded-Proto $scheme;
         proxy_pass http://${privatedns}:8076/;
       }

        location /billing-api/ {
           resolver 127.0.0.1 valid=30s;
           proxy_http_version 1.1;
           proxy_set_header Connection "";
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_buffering off;
           proxy_pass  http://${privatedns}:8117/;
        }

        location /billing-swagger/ {
         proxy_set_header X-Forwarded-Host $host/billing-api/;
         proxy_set_header X-Forwarded-Proto $scheme;
         proxy_pass http://${privatedns}:8117/;
       }


    #error_page  404              /404.html;

    # redirect server error pages to the static page /50x.html
    #
    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
        root   /usr/share/nginx/html;
    }

    # proxy the PHP scripts to Apache listening on 127.0.0.1:80
    #
    #location ~ \.php$ {
    #    proxy_pass   http://127.0.0.1;
    #}

    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
    #
    #location ~ \.php$ {
    #    root           html;
    #    fastcgi_pass   127.0.0.1:9000;
    #    fastcgi_index  index.php;
    #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;
    #    include        fastcgi_params;
    #}

    # deny access to .htaccess files, if Apache's document root
    # concurs with nginx's one
    #
    #location ~ /\.ht {
    #    deny  all;
    #}
}